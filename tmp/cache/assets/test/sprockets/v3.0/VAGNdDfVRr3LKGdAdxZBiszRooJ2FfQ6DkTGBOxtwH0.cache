I"í(function() {
  var formatSearchResults;

  $(window).load(function() {
    if (window.currentController === "hospitals") {
      return $("#spotlight-search-query").on("keyup", function(e) {
        if ($.trim($(this).val()).length > 2) {
          $("form#spotlight-search").submit();
        } else {
          $(".search-results-popover").hide();
        }
        return $("form#spotlight-search").on("submit", function(e) {
          e.preventDefault();
          return $.post($(this).attr("action"), {
            query: $("#spotlight-search-query").val()
          }, function(data) {
            var content, receiver;
            content = formatSearchResults(data);
            receiver = $(".search-results-popover");
            receiver.html(content);
            return receiver.show();
          }, "json");
        });
      });
    }
  });

  formatSearchResults = function(searchData) {
    var content, i, len, result, resultType;
    content = $("<div class='search-results'>");
    if (searchData != null) {
      for (i = 0, len = searchData.length; i < len; i++) {
        result = searchData[i];
        if (result != null) {
          resultType = result.searchable_type.toLowerCase() + "s";
          content.append("<a href='/" + resultType + "/" + result.searchable_id + "'>" + result.term + "</a>" + "<br>");
        }
      }
    } else {
      content.append("<p class='no-results'>No results found.</p>");
    }
    content.append("</div>");
    return content;
  };

}).call(this);
:ET